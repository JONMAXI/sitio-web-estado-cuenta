<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detalle Cliente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .accordion-button { font-weight: 700; color: #222; }
        .info-label { font-weight: 600; color: #495057; }
        .info-value { word-break: break-word; }
        .section-title { margin-top: 1rem; color: #0d6efd; font-size: 1.05rem; font-weight:700; }
        .images img { max-height: 120px; margin: 0.25rem; border-radius: 8px; }
        .meta-badge { font-size: 0.85rem; margin-left: 0.5rem; color:#6c757d; }
        .btn-back { margin-top: 1.5rem; }
        .small-muted { font-size:0.9rem; color:#6c757d; }
        .group { padding: .35rem 0; border-bottom: 1px dashed #e9ecef; margin-bottom: .5rem; }
    </style>
</head>
<body>
<div class="container py-4">

    {% if resultados %}
        <div class="accordion" id="accordionClientes">
            {% for r in resultados %}
            <div class="accordion-item mb-3">
                <h2 class="accordion-header" id="heading{{ loop.index }}">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ loop.index }}" aria-expanded="false" aria-controls="collapse{{ loop.index }}">
                        {{ r.nombre_completo_cliente or r.nombre_cliente }} — Crédito: {{ r.id_credito }} — {{ r.estatus }}
                        <span class="meta-badge">CP: {{ r.cp or '—' }} · Tel: {{ r.telefono_celular or '—' }}</span>
                    </button>
                </h2>

                <div id="collapse{{ loop.index }}" class="accordion-collapse collapse" data-bs-parent="#accordionClientes">
                    <div class="accordion-body">

                        <!-- IDENTIFICACIÓN Y ASIGNACIÓN -->
                        <h5 class="section-title">Identificación y asignación</h5>
                        <div class="group row">
                            <div class="col-md-4 info-label">ID:</div><div class="col-md-8 info-value">{{ r.id }}</div>
                            <div class="col-md-4 info-label">id_team:</div><div class="col-md-8 info-value">{{ r.id_team }}</div>
                            <div class="col-md-4 info-label">team_supervisor:</div><div class="col-md-8 info-value">{{ r.team_supervisor }}</div>
                            <div class="col-md-4 info-label">id_base:</div><div class="col-md-8 info-value">{{ r.id_base }}</div>
                            <div class="col-md-4 info-label">nombre_base:</div><div class="col-md-8 info-value">{{ r.nombre_base }}</div>
                            <div class="col-md-4 info-label">fecha_carga_base:</div><div class="col-md-8 info-value">{{ r.fecha_carga_base }}</div>
                            <div class="col-md-4 info-label">id_registro:</div><div class="col-md-8 info-value">{{ r.id_registro }}</div>
                            <div class="col-md-4 info-label">id_key:</div><div class="col-md-8 info-value">{{ r.id_key }}</div>
                            <div class="col-md-4 info-label">usuario_asignado:</div><div class="col-md-8 info-value">{{ r.usuario_asignado }}</div>
                            <div class="col-md-4 info-label">codigo_gestor:</div><div class="col-md-8 info-value">{{ r.codigo_gestor }}</div>
                            <div class="col-md-4 info-label">usuario (sistema):</div><div class="col-md-8 info-value">{{ r.usuario }}</div>
                        </div>

                        <!-- DATOS DEL CLIENTE Y CRÉDITO -->
                        <h5 class="section-title">Datos del cliente y crédito</h5>
                        <div class="group row">
                            <div class="col-md-4 info-label">nombre_cliente:</div><div class="col-md-8 info-value">{{ r.nombre_cliente }}</div>
                            <div class="col-md-4 info-label">nombre_completo_cliente:</div><div class="col-md-8 info-value">{{ r.nombre_completo_cliente }}</div>
                            <div class="col-md-4 info-label">id_credito:</div><div class="col-md-8 info-value">{{ r.id_credito }}</div>
                            <div class="col-md-4 info-label">cuenta_clabe:</div><div class="col-md-8 info-value">{{ r.cuenta_clabe }}</div>
                            <div class="col-md-4 info-label">pago_semanal:</div><div class="col-md-8 info-value">{{ r.pago_semanal }}</div>
                            <div class="col-md-4 info-label">pagos_vencidos:</div><div class="col-md-8 info-value">{{ r.pagos_vencidos }}</div>
                            <div class="col-md-4 info-label">deuda_total:</div><div class="col-md-8 info-value">{{ r.deuda_total }}</div>
                            <div class="col-md-4 info-label">estatus:</div><div class="col-md-8 info-value">{{ r.estatus }}</div>
                            <div class="col-md-4 info-label">promesa_pago:</div><div class="col-md-8 info-value">{{ r.promesa_pago }}</div>
                            <div class="col-md-4 info-label">motivo_negativa:</div><div class="col-md-8 info-value">{{ r.motivo_negativa }}</div>
                            <div class="col-md-4 info-label">porque_atraso_pago:</div><div class="col-md-8 info-value">{{ r.porque_atraso_pago }}</div>
                            <div class="col-md-4 info-label">con_quien_mala_experiencia:</div><div class="col-md-8 info-value">{{ r.con_quien_mala_experiencia }}</div>
                        </div>

                        <!-- CONTACTOS Y REFERENCIAS -->
                        <h5 class="section-title">Contactos y referencias</h5>
                        <div class="group row">
                            <div class="col-md-4 info-label">referencia_personal1:</div><div class="col-md-8 info-value">{{ r.referencia_personal1 }}</div>
                            <div class="col-md-4 info-label">parentesco1:</div><div class="col-md-8 info-value">{{ r.parentesco1 }}</div>
                            <div class="col-md-4 info-label">telefono_referencia1:</div><div class="col-md-8 info-value">{{ r.telefono_referencia1 }}</div>

                            <div class="col-md-4 info-label">referencia_personal2:</div><div class="col-md-8 info-value">{{ r.referencia_personal2 }}</div>
                            <div class="col-md-4 info-label">parentesco2:</div><div class="col-md-8 info-value">{{ r.parentesco2 }}</div>
                            <div class="col-md-4 info-label">telefono_referencia2:</div><div class="col-md-8 info-value">{{ r.telefono_referencia2 }}</div>

                            <div class="col-md-4 info-label">contacto:</div><div class="col-md-8 info-value">{{ r.contacto }}</div>
                            <div class="col-md-4 info-label">medio_contactacion_ccc:</div><div class="col-md-8 info-value">{{ r.medio_contactacion_ccc }}</div>
                            <div class="col-md-4 info-label">medio_contactacion_campo:</div><div class="col-md-8 info-value">{{ r.medio_contactacion_campo }}</div>
                            <div class="col-md-4 info-label">dictamen_campo:</div><div class="col-md-8 info-value">{{ r.dictamen_campo }}</div>
                            <div class="col-md-4 info-label">dictamen_ccc:</div><div class="col-md-8 info-value">{{ r.dictamen_ccc }}</div>
                        </div>

                        <!-- DIRECCIONES Y UBICACIÓN -->
                        <h5 class="section-title">Direcciones y ubicación</h5>
                        <div class="group row">
                            <div class="col-md-4 info-label">direccion:</div><div class="col-md-8 info-value">{{ r.direccion }}</div>
                            <div class="col-md-4 info-label">direccion_ine:</div><div class="col-md-8 info-value">{{ r.direccion_ine }}</div>
                            <div class="col-md-4 info-label">direccion_actual:</div><div class="col-md-8 info-value">{{ r.direccion_actual }}</div>
                            <div class="col-md-4 info-label">direccion_geo:</div><div class="col-md-8 info-value">{{ r.direccion_geo }}</div>
                            <div class="col-md-4 info-label">geolocalizacion:</div><div class="col-md-8 info-value">{{ r.geolocalizacion }}</div>
                            <div class="col-md-4 info-label">longitud:</div><div class="col-md-8 info-value">{{ r.longitud }}</div>
                            <div class="col-md-4 info-label">latitud:</div><div class="col-md-8 info-value">{{ r.latitud }}</div>
                            <div class="col-md-4 info-label">ubicacion_usuario:</div><div class="col-md-8 info-value">{{ r.ubicacion_usuario }}</div>
                            <div class="col-md-4 info-label">fake_gps:</div><div class="col-md-8 info-value">{{ r.fake_gps }}</div>
                            <div class="col-md-4 info-label">secure_area:</div><div class="col-md-8 info-value">{{ r.secure_area }}</div>
                            <div class="col-md-4 info-label">actualizacion_direccion:</div><div class="col-md-8 info-value">{{ r.actualizacion_direccion }}</div>
                            <div class="col-md-4 info-label">actualizacion_telefono:</div><div class="col-md-8 info-value">{{ r.actualizacion_telefono }}</div>
                            <div class="col-md-4 info-label">donde_firma:</div><div class="col-md-8 info-value">{{ r.donde_firma }}</div>
                        </div>

                        <!-- VEHÍCULO / DISPOSITIVO -->
                        <h5 class="section-title">Vehículo / Dispositivo</h5>
                        <div class="group row">
                            <div class="col-md-4 info-label">kilometraje:</div><div class="col-md-8 info-value">{{ r.kilometraje }}</div>
                            <div class="col-md-4 info-label">numero_serie:</div><div class="col-md-8 info-value">{{ r.numero_serie }}</div>
                            <div class="col-md-4 info-label">marca_modelo:</div><div class="col-md-8 info-value">{{ r.marca_modelo }}</div>
                            <div class="col-md-4 info-label">device_imei:</div><div class="col-md-8 info-value">{{ r.device_imei }}</div>
                        </div>

                        <!-- DOCUMENTOS Y MULTIMEDIA -->
                        <h5 class="section-title">Documentos y multimedia</h5>
                        <div class="group">
                            <div class="images">
                                {% if r.foto1 %}<img src="{{ r.foto1 }}" alt="Foto 1">{% endif %}
                                {% if r.foto2 %}<img src="{{ r.foto2 }}" alt="Foto 2">{% endif %}
                                {% if r.foto3 %}<img src="{{ r.foto3 }}" alt="Foto 3">{% endif %}
                            </div>
                            <div class="mt-2">
                                {% if r.adjunto %}<a href="{{ r.adjunto }}" class="btn btn-sm btn-outline-primary me-2" target="_blank">Adjunto</a>{% endif %}
                                {% if r.video %}<a href="{{ r.video }}" class="btn btn-sm btn-outline-secondary me-2" target="_blank">Video</a>{% endif %}
                                {% if r.images %}<span class="small-muted">images: {{ r.images }}</span>{% endif %}
                            </div>
                        </div>

                        <!-- FECHAS Y SISTEMA -->
                        <h5 class="section-title">Fechas y sistema</h5>
                        <div class="group row">
                            <div class="col-md-4 info-label">fecha_hora:</div><div class="col-md-8 info-value">{{ r.fecha_hora }}</div>
                            <div class="col-md-4 info-label">fecha_sistema:</div><div class="col-md-8 info-value">{{ r.fecha_sistema }}</div>
                            <div class="col-md-4 info-label">fecha_dispositivo:</div><div class="col-md-8 info-value">{{ r.fecha_dispositivo }}</div>
                        </div>

                        <!-- COMENTARIOS -->
                        <h5 class="section-title">Comentarios y notas</h5>
                        <div class="group">
                            <div class="info-value">{{ r.comentarios_generales }}</div>
                        </div>

                        <!-- BOTÓN ACCIONES / NUEVA BÚSQUEDA -->
                        <div class="mt-3">
                            <a href="/busqueda_base_cliente" class="btn btn-primary">Nueva Búsqueda</a>
                            <!-- ejemplo: botón para abrir en modal o nueva ventana -->
                            <!-- <a href="/editar/{{ r.id }}" class="btn btn-outline-secondary">Editar</a> -->
                        </div>

                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

    {% else %}
        <div class="alert alert-warning">No hay resultados para mostrar.</div>
    {% endif %}

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
