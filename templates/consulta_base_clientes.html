<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detalle Cliente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .accordion-button { font-weight: 600; }
        .info-label { font-weight: 600; color: #495057; }
        .info-value { word-break: break-word; }
        .section-title { margin-top: 1rem; color: #0d6efd; font-size: 1.1rem; }
        .images img { max-height: 120px; margin: 0.25rem; border-radius: 8px; }
        .btn-back { margin-top: 1.5rem; }
    </style>
</head>
<body>
<div class="container py-4">

    {% if resultados %}
        <div class="accordion" id="accordionClientes">
            {% for r in resultados %}
            <div class="accordion-item">
                <h2 class="accordion-header" id="heading{{ loop.index }}">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ loop.index }}">
                        {{ r.nombre_completo_cliente }} — Crédito: {{ r.id_credito }} — {{ r.estatus }}
                    </button>
                </h2>
                <div id="collapse{{ loop.index }}" class="accordion-collapse collapse" data-bs-parent="#accordionClientes">
                    <div class="accordion-body">

                        <!-- Información General -->
                        <h5 class="section-title">Información General</h5>
                        <div class="row"><div class="col-md-4 info-label">ID:</div><div class="col-md-8 info-value">{{ r.id }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Pagos vencidos:</div><div class="col-md-8 info-value">{{ r.pagos_vencidos }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Deuda total:</div><div class="col-md-8 info-value">{{ r.deuda_total }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Pago semanal:</div><div class="col-md-8 info-value">{{ r.pago_semanal }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Teléfono celular:</div><div class="col-md-8 info-value">{{ r.telefono_celular }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Dirección:</div><div class="col-md-8 info-value">{{ r.direccion_actual or r.direccion }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Código postal:</div><div class="col-md-8 info-value">{{ r.cp }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Promesa de pago:</div><div class="col-md-8 info-value">{{ r.promesa_pago }}</div></div>

                        <!-- Contactos -->
                        <h5 class="section-title">Contactos y Referencias</h5>
                        <div class="row"><div class="col-md-4 info-label">Referencia 1:</div><div class="col-md-8 info-value">{{ r.referencia_personal1 }} - {{ r.parentesco1 }} - {{ r.telefono_referencia1 }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Referencia 2:</div><div class="col-md-8 info-value">{{ r.referencia_personal2 }} - {{ r.parentesco2 }} - {{ r.telefono_referencia2 }}</div></div>

                        <!-- Documentos -->
                        <h5 class="section-title">Documentos y Multimedia</h5>
                        <div class="images">
                            {% if r.foto1 %}<img src="{{ r.foto1 }}" alt="Foto 1">{% endif %}
                            {% if r.foto2 %}<img src="{{ r.foto2 }}" alt="Foto 2">{% endif %}
                            {% if r.foto3 %}<img src="{{ r.foto3 }}" alt="Foto 3">{% endif %}
                            {% if r.adjunto %}<a href="{{ r.adjunto }}" class="btn btn-sm btn-outline-primary">Adjunto</a>{% endif %}
                            {% if r.video %}<a href="{{ r.video }}" class="btn btn-sm btn-outline-secondary">Video</a>{% endif %}
                        </div>

                        <!-- Extra -->
                        <h5 class="section-title">Información Extra</h5>
                        <div class="row"><div class="col-md-4 info-label">Geolocalización:</div><div class="col-md-8 info-value">{{ r.geolocalizacion }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Dispositivo IMEI:</div><div class="col-md-8 info-value">{{ r.device_imei }}</div></div>
                        <div class="row"><div class="col-md-4 info-label">Última actualización:</div><div class="col-md-8 info-value">{{ r.fecha_actualizacion or r.fecha_sistema }}</div></div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <a href="/busqueda_base_cliente" class="btn btn-primary w-100 btn-back">Nueva Búsqueda</a>
    {% else %}
        <div class="alert alert-warning">No hay resultados para mostrar.</div>
    {% endif %}

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
